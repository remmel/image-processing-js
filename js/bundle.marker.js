!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=40)}({40:function(e,t,n){"use strict";n.r(t);let r=new function(e){let t=this;function n(){t.onCameraStartedCallback&&t.onCameraStartedCallback(t.stream,t.video)}this.errorOutput=document.getElementById(e),this.loadOpenCv=function(e){let n=document.createElement("script");n.setAttribute("async",""),n.setAttribute("type","text/javascript"),n.addEventListener("load",async()=>{cv.getBuildInformation?(console.log(cv.getBuildInformation()),e()):cv instanceof Promise?(cv=await cv,console.log(cv.getBuildInformation()),e()):cv.onRuntimeInitialized=()=>{console.log(cv.getBuildInformation()),e()}}),n.addEventListener("error",()=>{t.printError("Failed to load experiments/ip/opencv-4.4.0.js")}),n.src="experiments/ip/opencv-4.4.0.js";let r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(n,r)},this.createFileFromUrl=function(e,n,r){let o=new XMLHttpRequest;o.open("GET",n,!0),o.responseType="arraybuffer",o.onload=function(i){if(4===o.readyState)if(200===o.status){let t=new Uint8Array(o.response);cv.FS_createDataFile("/",e,t,!0,!1,!1),r()}else t.printError("Failed to load "+n+" status: "+o.status)},o.send()},this.loadImageToCanvas=function(e,t){let n=document.getElementById(t),r=n.getContext("2d"),o=new Image;o.crossOrigin="anonymous",o.onload=function(){n.width=o.width,n.height=o.height,r.drawImage(o,0,0,o.width,o.height)},o.src=e},this.clearError=function(){this.errorOutput.innerHTML=""},this.printError=function(e){if(void 0===e)e="";else if("number"==typeof e)isNaN(e)||"undefined"!=typeof cv&&(e="Exception: "+cv.exceptionFromPtr(e).msg);else if("string"==typeof e){let t=Number(e.split(" ")[0]);isNaN(t)||"undefined"!=typeof cv&&(e="Exception: "+cv.exceptionFromPtr(t).msg)}else e instanceof Error&&(e=e.stack.replace(/\n/g,"<br>"));this.errorOutput.innerHTML=e},this.loadCode=function(e,t){let n=document.getElementById(e),r=document.getElementById(t);if("text/code-snippet"!==n.type)throw Error("Unknown code snippet type");r.value=n.text.replace(/^\n/,"")},this.addFileInputHandler=function(e,n){document.getElementById(e).addEventListener("change",e=>{let r=e.target.files;if(r.length>0){let e=URL.createObjectURL(r[0]);t.loadImageToCanvas(e,n)}},!1)},this.startCamera=function(e,r,o){let i=document.getElementById(o);i||(i=document.createElement("video"));let a={qvga:{width:{exact:320},height:{exact:240}},vga:{width:{exact:640},height:{exact:480}}}[e];a||(a=!0),navigator.mediaDevices.getUserMedia({video:a,audio:!1}).then((function(e){i.srcObject=e,i.play(),t.video=i,t.stream=e,t.onCameraStartedCallback=r,i.addEventListener("canplay",n,!1)})).catch((function(e){t.printError("Camera Error: "+e.name+" "+e.message)}))},this.stopCamera=function(){this.video&&(this.video.pause(),this.video.srcObject=null,this.video.removeEventListener("canplay",n)),this.stream&&this.stream.getVideoTracks()[0].stop()}}("errorMessage"),o=!1,i=document.getElementById("videoInput"),a=document.getElementById("startAndStop"),c=document.getElementById("canvasOutput"),d=c.getContext("2d");function l(){o=!0,a.innerText="Stop",i.width=i.videoWidth,i.height=i.videoHeight,function(){let e=document.getElementById("videoInput"),t=new cv.Mat(e.height,e.width,cv.CV_8UC4),n=new cv.Mat(e.height,e.width,cv.CV_8UC4),i=new cv.Mat,a=new cv.VideoCapture(e),c=new cv.RectVector,d=new cv.CascadeClassifier;d.load("haarcascade_frontalface_default.xml");setTimeout((function e(){try{if(!o)return t.delete(),n.delete(),i.delete(),c.delete(),void d.delete();let r=Date.now();a.read(t),t.copyTo(n),cv.cvtColor(n,i,cv.COLOR_RGBA2GRAY,0),d.detectMultiScale(i,c,1.1,3,0);for(let e=0;e<c.size();++e){let t=c.get(e),r=new cv.Point(t.x,t.y),o=new cv.Point(t.x+t.width,t.y+t.height);cv.rectangle(n,r,o,[255,0,0,255])}cv.imshow("canvasOutput",n);let l=1e3/30-(Date.now()-r);setTimeout(e,l)}catch(e){r.printError(e)}}),0)}()}a.addEventListener("click",()=>{o?(r.stopCamera(),o=!1,d.clearRect(0,0,c.width,c.height),a.innerText="Start"):(r.clearError(),r.startCamera("qvga",l,"videoInput"))}),r.loadOpenCv(()=>{r.createFileFromUrl("haarcascade_frontalface_default.xml","experiments/ip/haarcascade_frontalface_default.xml",()=>{a.removeAttribute("disabled")})})}});
//# sourceMappingURL=bundle.marker.js.map